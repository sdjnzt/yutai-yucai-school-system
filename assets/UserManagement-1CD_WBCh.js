import{r as m,I as W,j as e,d as F,S as h,B as x,N as X,R as ee,T as P}from"./index-BWITRwMt.js";import{d as q}from"./dayjs.min-gRUIGo67.js";import{F as l}from"./index-B4Ba3kjL.js";import{C as j,R as u,a}from"./row-Cnghy05A.js";import{T as se}from"./index-KgziiaPg.js";import{S as w}from"./index-Cvv5Oy9s.js";import{R as z}from"./CheckCircleOutlined-DhoaOLGr.js";import{R as O}from"./ApartmentOutlined-BrTogBa-.js";import{I as d}from"./index-DHsOOk53.js";import{R as te}from"./SearchOutlined-BYrytDiN.js";import{S as c}from"./index--971HAJd.js";import{R as re,a as le}from"./FilterOutlined-C-tDQmlT.js";import{R as ne}from"./PlusOutlined-DTmrJA1a.js";import{F as ae}from"./Table-Co4vqh-S.js";import{M as B}from"./index-B6GfVDaP.js";import{A as Y}from"./index-XeX9iwEh.js";import{R as D}from"./LockOutlined-DFR-yF6K.js";import{T as g}from"./index-Bi3wrssA.js";import{R as ie}from"./MailOutlined-DmD4khBi.js";import{R as oe}from"./PhoneOutlined-Bt8GPECc.js";import{S as ce}from"./index-Dny0oP1B.js";import{R as de,a as me}from"./EditOutlined-Pz7OHA1y.js";import{R as he}from"./KeyOutlined-CJ6TnYlR.js";import{P as xe}from"./index-S-_C2KLB.js";import{s as I}from"./index-DUFlJjEf.js";import"./EditOutlined-OPXnklqI.js";import"./EyeOutlined-BFSnxg4C.js";import"./CalendarOutlined-DKq2sctu.js";import"./DeleteOutlined-DFutYCzo.js";var je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"};function k(){return k=Object.assign?Object.assign.bind():function(n){for(var i=1;i<arguments.length;i++){var p=arguments[i];for(var o in p)Object.prototype.hasOwnProperty.call(p,o)&&(n[o]=p[o])}return n},k.apply(this,arguments)}const ue=(n,i)=>m.createElement(W,k({},n,{ref:i,icon:je})),E=m.forwardRef(ue),{Title:pe,Text:U}=se,{Option:t}=c,Ne=()=>{const[n]=l.useForm(),[i]=l.useForm(),[p,o]=m.useState(!1),[_,R]=m.useState(!1),[fe,b]=m.useState(null),[S,C]=m.useState("create"),M=()=>{const s=["管理员","教务主任","学生主任","总务主任","教师","班主任"],r=["教务处","学生处","总务处","实验室","体育组"];return[{name:"王明华",title:"高级教师"},{name:"李秀英",title:"特级教师"},{name:"张建国",title:"高级教师"},{name:"刘淑华",title:"一级教师"},{name:"陈志强",title:"高级教师"},{name:"赵丽娟",title:"特级教师"},{name:"杨光明",title:"一级教师"},{name:"周晓梅",title:"高级教师"},{name:"吴国强",title:"一级教师"},{name:"孙玉兰",title:"高级教师"},{name:"郑伟东",title:"特级教师"},{name:"马丽华",title:"一级教师"}].map((y,$)=>{const Q=s[Math.floor(Math.random()*s.length)],Z=r[Math.floor(Math.random()*r.length)],T=`${y.name.slice(0,1)}${y.name.slice(-1)}${String($+1).padStart(4,"0")}`,G=q("2025-07-25").subtract(Math.floor(Math.random()*7),"day").format("YYYY-MM-DD HH:mm:ss"),K=q("2025-07-25").subtract(Math.floor(Math.random()*365),"day").format("YYYY-MM-DD HH:mm:ss");return{key:$+1,id:`U${String($+1).padStart(4,"0")}`,username:T,name:y.name,title:y.title,role:Q,department:Z,email:`${T}@yutai.edu.cn`,phone:`1${Math.floor(Math.random()*9e9+1e9)}`,status:Math.random()>.1?"正常":"禁用",lastLoginTime:G,createTime:K}})},v=m.useMemo(()=>{const s=M();return{total:s.length,active:s.filter(r=>r.status==="正常").length,disabled:s.filter(r=>r.status==="禁用").length,departments:new Set(s.map(r=>r.department)).size}},[]),A=s=>{console.log("Form values:",s),I.success(`${S==="create"?"创建":"更新"}用户成功`),o(!1),n.resetFields()},H=s=>{console.log("Reset password:",s),I.success("密码重置成功"),R(!1),n.resetFields()},L=s=>{C("edit"),b(s),n.setFieldsValue(s),o(!0)},V=s=>{I.success("删除成功")},J=(s,r)=>{I.success(`用户${s?"启用":"禁用"}成功`)},N=[{title:"用户信息",dataIndex:"name",key:"name",width:250,fixed:"left",render:(s,r)=>e.jsxs(h,{children:[e.jsx(X,{icon:e.jsx(ee,{})}),e.jsxs(h,{direction:"vertical",size:0,children:[e.jsx(U,{strong:!0,children:s}),e.jsx(U,{type:"secondary",style:{fontSize:12},children:r.username})]}),e.jsx(g,{color:"blue",children:r.title})]})},{title:"所属部门",dataIndex:"department",key:"department",width:120,render:s=>e.jsx(g,{icon:e.jsx(O,{}),color:"purple",children:s})},{title:"角色",dataIndex:"role",key:"role",width:120,render:s=>e.jsx(g,{icon:e.jsx(F,{}),color:"cyan",children:s})},{title:"联系方式",key:"contact",width:300,render:(s,r)=>e.jsxs(h,{children:[e.jsx(P,{title:"邮箱",children:e.jsx(g,{icon:e.jsx(ie,{}),children:r.email})}),e.jsx(P,{title:"电话",children:e.jsx(g,{icon:e.jsx(oe,{}),children:r.phone})})]})},{title:"状态",dataIndex:"status",key:"status",width:120,render:(s,r)=>e.jsx(ce,{checkedChildren:e.jsx(z,{}),unCheckedChildren:e.jsx(E,{}),checked:s==="正常",onChange:f=>J(f)})},{title:"最后登录",dataIndex:"lastLoginTime",key:"lastLoginTime",width:180,render:s=>e.jsxs(h,{children:[e.jsx(le,{}),e.jsx("span",{children:s})]})},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:180},{title:"操作",key:"action",width:250,fixed:"right",render:(s,r)=>e.jsxs(h,{children:[e.jsx(x,{type:"link",icon:e.jsx(de,{}),onClick:()=>L(r),children:"编辑"}),e.jsx(x,{type:"link",icon:e.jsx(he,{}),onClick:()=>{b(r),R(!0)},children:"重置密码"}),e.jsx(xe,{title:"确定要删除该用户吗？",onConfirm:()=>V(),okText:"确定",cancelText:"取消",children:e.jsx(x,{type:"link",danger:!0,icon:e.jsx(me,{}),children:"删除"})})]})}];return e.jsxs("div",{children:[e.jsxs(j,{children:[e.jsx(pe,{level:4,children:"用户管理"}),e.jsxs(u,{gutter:[16,16],style:{marginBottom:24},children:[e.jsx(a,{span:6,children:e.jsx(j,{children:e.jsx(w,{title:"用户总数",value:v.total,prefix:e.jsx(F,{style:{color:"#1890ff"}})})})}),e.jsx(a,{span:6,children:e.jsx(j,{children:e.jsx(w,{title:"正常用户",value:v.active,valueStyle:{color:"#52c41a"},prefix:e.jsx(z,{})})})}),e.jsx(a,{span:6,children:e.jsx(j,{children:e.jsx(w,{title:"禁用用户",value:v.disabled,valueStyle:{color:"#ff4d4f"},prefix:e.jsx(E,{})})})}),e.jsx(a,{span:6,children:e.jsx(j,{children:e.jsx(w,{title:"部门数量",value:v.departments,prefix:e.jsx(O,{style:{color:"#722ed1"}}),suffix:"个"})})})]}),e.jsx(j,{style:{marginBottom:16},children:e.jsxs(u,{justify:"space-between",align:"middle",style:{marginBottom:16},children:[e.jsx(a,{children:e.jsxs(l,{form:i,layout:"inline",children:[e.jsx(l.Item,{name:"keyword",children:e.jsx(d,{placeholder:"搜索用户名/姓名",prefix:e.jsx(te,{}),style:{width:200}})}),e.jsx(l.Item,{name:"department",children:e.jsxs(c,{placeholder:"所属部门",style:{width:160},allowClear:!0,children:[e.jsx(t,{value:"教务处",children:"教务处"}),e.jsx(t,{value:"学生处",children:"学生处"}),e.jsx(t,{value:"总务处",children:"总务处"}),e.jsx(t,{value:"实验室",children:"实验室"}),e.jsx(t,{value:"体育组",children:"体育组"})]})}),e.jsx(l.Item,{name:"role",children:e.jsxs(c,{placeholder:"角色",style:{width:160},allowClear:!0,children:[e.jsx(t,{value:"管理员",children:"管理员"}),e.jsx(t,{value:"教务主任",children:"教务主任"}),e.jsx(t,{value:"学生主任",children:"学生主任"}),e.jsx(t,{value:"总务主任",children:"总务主任"}),e.jsx(t,{value:"教师",children:"教师"}),e.jsx(t,{value:"班主任",children:"班主任"})]})}),e.jsx(l.Item,{name:"status",children:e.jsxs(c,{placeholder:"状态",style:{width:120},allowClear:!0,children:[e.jsx(t,{value:"正常",children:"正常"}),e.jsx(t,{value:"禁用",children:"禁用"})]})}),e.jsx(l.Item,{children:e.jsxs(h,{children:[e.jsx(x,{type:"primary",icon:e.jsx(re,{}),children:"筛选"}),e.jsx(x,{onClick:()=>i.resetFields(),children:"重置"})]})})]})}),e.jsx(a,{children:e.jsx(x,{type:"primary",icon:e.jsx(ne,{}),onClick:()=>{C("create"),b(null),n.resetFields(),o(!0)},children:"新建用户"})})]})}),e.jsx(ae,{columns:N,dataSource:M(),pagination:{pageSize:10,showQuickJumper:!0,showSizeChanger:!0,showTotal:s=>`共 ${s} 条记录`},scroll:{x:1500}})]}),e.jsxs(B,{title:`${S==="create"?"新建":"编辑"}用户`,open:p,onOk:()=>n.submit(),onCancel:()=>{o(!1),n.resetFields()},width:700,children:[e.jsx(Y,{message:"温馨提示",description:S==="create"?"新建用户的初始密码为123456，请提醒用户及时修改密码。":"编辑用户信息不会修改用户的密码。",type:"info",showIcon:!0,style:{marginBottom:24}}),e.jsxs(l,{form:n,layout:"vertical",onFinish:A,children:[e.jsxs(u,{gutter:16,children:[e.jsx(a,{span:12,children:e.jsx(l.Item,{name:"username",label:"用户名",rules:[{required:!0,message:"请输入用户名"},{pattern:/^[a-zA-Z0-9_]{4,20}$/,message:"用户名只能包含字母、数字和下划线，长度4-20位"}],children:e.jsx(d,{placeholder:"请输入用户名"})})}),e.jsx(a,{span:12,children:e.jsx(l.Item,{name:"name",label:"姓名",rules:[{required:!0,message:"请输入姓名"}],children:e.jsx(d,{placeholder:"请输入姓名"})})})]}),e.jsxs(u,{gutter:16,children:[e.jsx(a,{span:12,children:e.jsx(l.Item,{name:"department",label:"所属部门",rules:[{required:!0,message:"请选择所属部门"}],children:e.jsxs(c,{placeholder:"请选择所属部门",children:[e.jsx(t,{value:"教务处",children:"教务处"}),e.jsx(t,{value:"学生处",children:"学生处"}),e.jsx(t,{value:"总务处",children:"总务处"}),e.jsx(t,{value:"实验室",children:"实验室"}),e.jsx(t,{value:"体育组",children:"体育组"})]})})}),e.jsx(a,{span:12,children:e.jsx(l.Item,{name:"role",label:"角色",rules:[{required:!0,message:"请选择角色"}],children:e.jsxs(c,{placeholder:"请选择角色",children:[e.jsx(t,{value:"管理员",children:"管理员"}),e.jsx(t,{value:"教务主任",children:"教务主任"}),e.jsx(t,{value:"学生主任",children:"学生主任"}),e.jsx(t,{value:"总务主任",children:"总务主任"}),e.jsx(t,{value:"教师",children:"教师"}),e.jsx(t,{value:"班主任",children:"班主任"})]})})})]}),e.jsxs(u,{gutter:16,children:[e.jsx(a,{span:12,children:e.jsx(l.Item,{name:"title",label:"职称",rules:[{required:!0,message:"请选择职称"}],children:e.jsxs(c,{placeholder:"请选择职称",children:[e.jsx(t,{value:"特级教师",children:"特级教师"}),e.jsx(t,{value:"高级教师",children:"高级教师"}),e.jsx(t,{value:"一级教师",children:"一级教师"})]})})}),e.jsx(a,{span:12,children:e.jsx(l.Item,{name:"status",label:"状态",rules:[{required:!0,message:"请选择状态"}],children:e.jsxs(c,{placeholder:"请选择状态",children:[e.jsx(t,{value:"正常",children:"正常"}),e.jsx(t,{value:"禁用",children:"禁用"})]})})})]}),e.jsxs(u,{gutter:16,children:[e.jsx(a,{span:12,children:e.jsx(l.Item,{name:"email",label:"邮箱",rules:[{required:!0,message:"请输入邮箱"},{type:"email",message:"请输入有效的邮箱地址"}],children:e.jsx(d,{placeholder:"请输入邮箱"})})}),e.jsx(a,{span:12,children:e.jsx(l.Item,{name:"phone",label:"手机号",rules:[{required:!0,message:"请输入手机号"},{pattern:/^1\d{10}$/,message:"请输入有效的手机号"}],children:e.jsx(d,{placeholder:"请输入手机号"})})})]})]})]}),e.jsxs(B,{title:"重置密码",open:_,onOk:()=>n.submit(),onCancel:()=>{R(!1),n.resetFields()},children:[e.jsx(Y,{message:"重置密码将清除用户的原密码，请谨慎操作！",type:"warning",showIcon:!0,style:{marginBottom:24}}),e.jsxs(l,{form:n,layout:"vertical",onFinish:H,children:[e.jsx(l.Item,{name:"newPassword",label:"新密码",rules:[{required:!0,message:"请输入新密码"},{min:6,message:"密码长度不能小于6位"}],children:e.jsx(d.Password,{placeholder:"请输入新密码",prefix:e.jsx(D,{})})}),e.jsx(l.Item,{name:"confirmPassword",label:"确认密码",rules:[{required:!0,message:"请确认新密码"},({getFieldValue:s})=>({validator(r,f){return!f||s("newPassword")===f?Promise.resolve():Promise.reject(new Error("两次输入的密码不一致"))}})],children:e.jsx(d.Password,{placeholder:"请确认新密码",prefix:e.jsx(D,{})})})]})]})]})};export{Ne as default};
