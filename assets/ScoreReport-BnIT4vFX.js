import{r as y,j as t,S as E,B as w,x as Y,D as g,c as $}from"./index-BVFfJd3t.js";import{F as p}from"./index-BiEj9eP2.js";import{C as u,R as G,a as x,T as V}from"./row-DAkbptQ2.js";import{S}from"./index-BO6PDH99.js";import{T as h}from"./index-BOzDQcKH.js";import{R as Z}from"./PrinterOutlined-D1ej7IOv.js";import{R as _}from"./DownloadOutlined-enYdzqOR.js";import{R as ee}from"./MailOutlined-CVH38emS.js";import{A as te}from"./index-Dmcu67QU.js";import{S as C}from"./index-dB5dkvR9.js";import{R as ae}from"./TrophyOutlined-Dpo84Owr.js";import{F as D}from"./Table-FIrAwD9v.js";import{M as se}from"./index-B6UrwPW0.js";import{I}from"./index-Bc9A0WOF.js";import{s as v}from"./index-Ip_IvEgE.js";import{T as ne}from"./index-BuW5QNsB.js";import"./DownloadOutlined-DTidZHln.js";import"./EditOutlined-D7TqcQsM.js";import"./EyeOutlined-BsOnOFxh.js";const{Title:ke,Paragraph:we}=ne,{TabPane:B}=V,{TextArea:ve}=I,Re=()=>{var T,F;const[r,O]=y.useState(null),[d,P]=y.useState(null),[z,M]=y.useState(!1),[j]=p.useForm(),f=[{id:"G1C1",name:"高一(1)班",type:"文科"},{id:"G1C2",name:"高一(2)班",type:"文科"},{id:"G1C3",name:"高一(3)班",type:"文科"},{id:"G1C4",name:"高一(4)班",type:"文科"},{id:"G1C5",name:"高一(5)班",type:"理科"},{id:"G1C6",name:"高一(6)班",type:"理科"},{id:"G1C7",name:"高一(7)班",type:"理科"},{id:"G1C8",name:"高一(8)班",type:"理科"}],R=[{id:"202507M",name:"2025年7月月考",type:"月考"},{id:"202507F",name:"2025年暑期补考",type:"补考"},{id:"202506F",name:"2025年期末考试",type:"期末"},{id:"202504M",name:"2025年4月月考",type:"月考"},{id:"202503M",name:"2025年3月月考",type:"月考"},{id:"202501F",name:"2025年期中考试",type:"期中"}],b=()=>{if(!r||!d)return[];const m=f.find(a=>a.id===r).type==="文科"?["语文","数学","英语","政治","历史","地理"]:["语文","数学","英语","物理","化学","生物"],l=[];for(let a=1;a<=50;a++){const o=`${r}${String(a).padStart(2,"0")}`,c={};let n=0;m.forEach(k=>{const X=70+Math.floor(Math.random()*20),A=Math.min(Math.max(X+Math.floor(Math.random()*20)-10,0),100);c[k]=A,n+=A}),l.push({key:o,studentId:o,name:q(),...c,totalScore:n,averageScore:Math.round(n/m.length),classRank:a,gradeRank:a+Math.floor(Math.random()*20)-10})}return l},L=()=>!r||!d?[]:(f.find(l=>l.id===r).type==="文科"?["语文","数学","英语","政治","历史","地理"]:["语文","数学","英语","物理","化学","生物"]).map(l=>{const a=70+Math.floor(Math.random()*10),o=40+Math.floor(Math.random()*8),c=10+Math.floor(Math.random()*10);return{key:l,subject:l,avgScore:a,maxScore:Math.min(a+20,100),minScore:Math.max(a-30,0),passCount:o,excellentCount:c,passRate:Math.round(o/50*100),excellentRate:Math.round(c/50*100)}}),q=()=>{const e=["张","李","王","刘","陈","杨","赵","黄","周","吴"],i=["伟","芳","娜","秀英","敏","静","丽","强","磊","军"];return e[Math.floor(Math.random()*e.length)]+i[Math.floor(Math.random()*i.length)]},J=e=>{O(e)},K=e=>{P(e)},N=()=>{v.success("正在打印成绩报告")},Q=()=>{v.success("成绩报告已导出")},H=()=>{j.validateFields().then(e=>{console.log("Email values:",e),M(!1),j.resetFields(),v.success("成绩报告已发送")})},s=y.useMemo(()=>{if(!r||!d)return null;const e=b(),i=e.length,m=Math.round(e.reduce((n,k)=>n+k.averageScore,0)/i),l=e.filter(n=>n.averageScore>=60).length,a=e.filter(n=>n.averageScore>=90).length,o=Math.max(...e.map(n=>n.averageScore)),c=Math.min(...e.map(n=>n.averageScore));return{total:i,avgScore:m,maxScore:o,minScore:c,passed:l,excellent:a,passRate:Math.round(l/i*100),excellentRate:Math.round(a/i*100)}},[r,d]),U=[{title:"学号",dataIndex:"studentId",key:"studentId",width:120,fixed:"left"},{title:"姓名",dataIndex:"name",key:"name",width:100,fixed:"left"},{title:"语文",dataIndex:"语文",key:"语文",width:100,render:e=>t.jsx("span",{style:{color:e>=60?"#52c41a":"#f5222d"},children:e})},{title:"数学",dataIndex:"数学",key:"数学",width:100,render:e=>t.jsx("span",{style:{color:e>=60?"#52c41a":"#f5222d"},children:e})},{title:"英语",dataIndex:"英语",key:"英语",width:100,render:e=>t.jsx("span",{style:{color:e>=60?"#52c41a":"#f5222d"},children:e})},{title:"物理",dataIndex:"物理",key:"物理",width:100,render:e=>e&&t.jsx("span",{style:{color:e>=60?"#52c41a":"#f5222d"},children:e})},{title:"化学",dataIndex:"化学",key:"化学",width:100,render:e=>e&&t.jsx("span",{style:{color:e>=60?"#52c41a":"#f5222d"},children:e})},{title:"生物",dataIndex:"生物",key:"生物",width:100,render:e=>e&&t.jsx("span",{style:{color:e>=60?"#52c41a":"#f5222d"},children:e})},{title:"政治",dataIndex:"政治",key:"政治",width:100,render:e=>e&&t.jsx("span",{style:{color:e>=60?"#52c41a":"#f5222d"},children:e})},{title:"历史",dataIndex:"历史",key:"历史",width:100,render:e=>e&&t.jsx("span",{style:{color:e>=60?"#52c41a":"#f5222d"},children:e})},{title:"地理",dataIndex:"地理",key:"地理",width:100,render:e=>e&&t.jsx("span",{style:{color:e>=60?"#52c41a":"#f5222d"},children:e})},{title:"总分",dataIndex:"totalScore",key:"totalScore",width:100,fixed:"right"},{title:"平均分",dataIndex:"averageScore",key:"averageScore",width:100,fixed:"right",render:e=>t.jsx("span",{style:{color:e>=60?"#52c41a":"#f5222d"},children:e})},{title:"班级排名",dataIndex:"classRank",key:"classRank",width:100,fixed:"right",render:e=>t.jsxs(h,{color:"blue",children:["第 ",e," 名"]})},{title:"年级排名",dataIndex:"gradeRank",key:"gradeRank",width:100,fixed:"right",render:e=>t.jsxs(h,{children:["第 ",e," 名"]})}],W=[{title:"学科",dataIndex:"subject",key:"subject",width:100,fixed:"left"},{title:"平均分",dataIndex:"avgScore",key:"avgScore",width:100},{title:"最高分",dataIndex:"maxScore",key:"maxScore",width:100},{title:"最低分",dataIndex:"minScore",key:"minScore",width:100},{title:"及格人数",dataIndex:"passCount",key:"passCount",width:100},{title:"优秀人数",dataIndex:"excellentCount",key:"excellentCount",width:100},{title:"及格率",dataIndex:"passRate",key:"passRate",width:100,render:e=>t.jsxs(h,{color:e>=85?"success":e>=60?"warning":"error",children:[e,"%"]})},{title:"优秀率",dataIndex:"excellentRate",key:"excellentRate",width:100,render:e=>t.jsxs(h,{color:e>=30?"success":e>=20?"warning":"error",children:[e,"%"]})}];return t.jsxs("div",{children:[t.jsx(u,{style:{marginBottom:16},children:t.jsxs(G,{gutter:16,align:"middle",children:[t.jsx(x,{span:8,children:t.jsx(S,{placeholder:"请选择班级",style:{width:"100%"},onChange:J,value:r,children:f.map(e=>t.jsxs(S.Option,{value:e.id,children:[e.name,t.jsx(h,{color:e.type==="文科"?"blue":"green",style:{marginLeft:8},children:e.type})]},e.id))})}),t.jsx(x,{span:8,children:t.jsx(S,{placeholder:"请选择考试",style:{width:"100%"},onChange:K,value:d,children:R.map(e=>t.jsxs(S.Option,{value:e.id,children:[e.name,t.jsx(h,{color:e.type==="期末"?"red":e.type==="期中"?"orange":e.type==="月考"?"blue":"purple",style:{marginLeft:8},children:e.type})]},e.id))})}),t.jsx(x,{span:8,style:{textAlign:"right"},children:t.jsxs(E,{children:[t.jsx(w,{icon:t.jsx(Z,{}),onClick:N,children:"打印报告"}),t.jsx(w,{icon:t.jsx(_,{}),onClick:Q,children:"导出报告"}),t.jsx(w,{type:"primary",icon:t.jsx(ee,{}),onClick:()=>M(!0),children:"发送报告"})]})})]})}),!r||!d?t.jsx(te,{message:"请选择班级和考试",description:"请先选择要生成报告的班级和考试",type:"info",showIcon:!0,style:{marginBottom:16}}):t.jsxs(t.Fragment,{children:[s&&t.jsxs(G,{gutter:16,style:{marginBottom:16},children:[t.jsx(x,{span:6,children:t.jsxs(u,{children:[t.jsx(C,{title:"班级平均分",value:s.avgScore,suffix:"分",prefix:t.jsx(Y,{})}),t.jsx(g,{style:{margin:"12px 0"}}),t.jsxs(E,{children:[t.jsxs("span",{children:["最高分：",s.maxScore]}),t.jsxs("span",{children:["最低分：",s.minScore]})]})]})}),t.jsx(x,{span:6,children:t.jsxs(u,{children:[t.jsx(C,{title:"及格率",value:s.passRate,suffix:"%",prefix:t.jsx($,{})}),t.jsx(g,{style:{margin:"12px 0"}}),t.jsxs("div",{children:["及格人数：",s.passed,"/",s.total]})]})}),t.jsx(x,{span:6,children:t.jsxs(u,{children:[t.jsx(C,{title:"优秀率",value:s.excellentRate,suffix:"%",prefix:t.jsx(ae,{})}),t.jsx(g,{style:{margin:"12px 0"}}),t.jsxs("div",{children:["优秀人数：",s.excellent,"/",s.total]})]})}),t.jsx(x,{span:6,children:t.jsxs(u,{children:[t.jsx(C,{title:"参考人数",value:s.total,suffix:"人",prefix:t.jsx($,{})}),t.jsx(g,{style:{margin:"12px 0"}}),t.jsxs("div",{children:["分差：",s.maxScore-s.minScore,"分"]})]})})]}),t.jsxs(V,{defaultActiveKey:"student",children:[t.jsx(B,{tab:"学生成绩单",children:t.jsx(D,{columns:U,dataSource:b(),scroll:{x:1800},pagination:{pageSize:10,showQuickJumper:!0,showSizeChanger:!0,showTotal:e=>`共 ${e} 名学生`}})},"student"),t.jsx(B,{tab:"学科统计",children:t.jsx(D,{columns:W,dataSource:L(),pagination:!1})},"subject")]})]}),t.jsx(se,{title:"发送成绩报告",open:z,onOk:H,onCancel:()=>{M(!1),j.resetFields()},children:t.jsxs(p,{form:j,layout:"vertical",children:[t.jsx(p.Item,{name:"emails",label:"收件人邮箱",rules:[{required:!0,message:"请输入收件人邮箱"}],children:t.jsx(I.TextArea,{placeholder:"请输入收件人邮箱，多个邮箱请用逗号分隔",rows:4})}),t.jsx(p.Item,{name:"subject",label:"邮件主题",initialValue:`${r?(T=f.find(e=>e.id===r))==null?void 0:T.name:""} ${d?(F=R.find(e=>e.id===d))==null?void 0:F.name:""} 成绩报告`,children:t.jsx(I,{})}),t.jsx(p.Item,{name:"content",label:"邮件内容",initialValue:"附件为成绩报告，请查收。",children:t.jsx(I.TextArea,{rows:4})})]})})]})};export{Re as default};
